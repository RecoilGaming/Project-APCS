# DEVELOPMENT JOURNAL
## P5 Phadke Sharvil

Worked on engine prior to May 20, **not** logged as journal entries *but it is still in the same git repository*

**IN CLASS** means this was worked on in class

**AT HOME** means this was worked on outside of class

**BOTH** means this was worked on in class and continued outside, or vice versa

### May 20 **AT HOME**
Made a quick shotgun class to test out some of the features of the engine I was not as experienced with. I stole sprites from terraria :). This inital version was meant to be very messy. I first got the shotgun sprite to show up and point towards the cursor. Doing so did require adding support for rotations to the engine, which was not there before. I used the internet to find an applicable class, AffineTransform / AffineTransformOp, and then used the API plus what I learned recently in math class to define transformation functions to rotate and flip (about either axis) our images, and added an enum to sprite that contained some common rotation types such as NORMAL (any direction) BIDIRECTIONAL (the sprite shouldn't rotate, but should flip so that the x direction matches the direction), LOCKED (doesn't rotate), and UPRIGHT, which is a combination of NORMAL and BIDIRECTIONAL. Using this, I now made the character use this generalized system and I had a shotgun that appeared when fired it, and faced the cursor but was always upright (the trigger always pointed down somewhat down, regardless of the rotation). I made the shotgun fire bullets (these are literally just bodies but with initial velocity).

### May 21 **BOTH**
Originally I intended the shotgun to be something to play around with, but I realized a lot of our other items later on will have similar mechanics. I generalized most of the shotgun functionality as a UsetimeItem, which is just a sprite that is shown next to the parent but in the direction of the mouse when a key is pressed, has a cooldown, and does something during / on the action. This is heavily inspired by Terraria, which has similar characteristics for most of it's items. The math was kind of annoying (but not particularly hard) for some of this, but I got through it. We'll be able to use this for all sorts of things, such as weapons, melee weapons swings, consumables if we have any, and things like that. I then fixed an issue with the camera, which was that adding it to a node did not change it's functionality like it was supposed to. The camera should be centered at the parent node. I changed the engine to propogate a global position down in update for Node2D objects. An issue I encountered was that, when the camera was fixed the scene moved and worked perfectly, but when I used mouse input the mouseinput was not as expected. I diagnosed the problem as the mouse input giving screen coordinates but the usecases requiring local coordinates or global coordinates in the game coordinate system, not the screen. I just shifted the mouse input to be correct based on the camera's most recent global position. TODO: projectiles won't work with server and are kind of laggy since they never remove themselves. I did make them stop drawing after a set cooldown, so that helps with the lag but after like 1-3 minutes of firing a total of 9 bullets per second, the lag got noticably bad. Some optimizations we should do is that nodes that rotate shouldn't recalculate rotations if the rotation changed. I also implemented this, but it got lost in a merge conflict unfortunately. Restoring the previous implementation would be more work than reimplementing. Finally, I started my journal so I don't have to backfill like I did last year :p